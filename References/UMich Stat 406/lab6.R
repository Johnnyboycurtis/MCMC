plot4hist <- function(Xbar5, Xbar12, Xbar25, M, V, Y, k)
{
   par(mfrow=c(2,2))
   s <- seq(M - k*sqrt(V), M + k*sqrt(V), by=.025)
   r <- hist(Xbar5, freq=FALSE, breaks=20, col=4, xlim=c(M - 2*sqrt(V), M + 2*sqrt(V)) )
   lines(s, dnorm(s, mean=M, sd=sqrt(V/N[1])), col=2)

   r <- hist(Xbar12, freq=FALSE, breaks=20, col=4, xlim=c(M - 2*sqrt(V)/1.5, M + 2*sqrt(V)/1.5) )
   lines(s, dnorm(s, mean=M, sd=sqrt(V/N[2])), col=2)

   r <- hist(Xbar25, freq=FALSE, breaks=20, col=4, xlim=c(M - 2*sqrt(V)/2, M + 2*sqrt(V)/2) )
   lines(s, dnorm(s, mean=M, sd=sqrt(V/N[3])), col=2)

   qqnorm(Y)
   qqline(Y)
}
N <- c(5, 12, 25)
X_5 <- matrix( runif(1000*N[1]), 1000, N[1])
X_12 <- matrix( runif(1000*N[2]), 1000, N[2])
X_25 <- matrix( runif(1000*N[3]), 1000, N[3])
Xbar_5 <- apply(X_5, 1, mean)
Xbar_12 <- apply(X_12, 1, mean)
Xbar_25 <- apply(X_25, 1, mean)
plot4hist(Xbar_5, Xbar_12, Xbar_25, .5, 1/12, runif(1000), 2)
X_5 <- matrix( rexp(1000*N[1],rate=.5), 1000, N[1])
X_12 <- matrix( rexp(1000*N[2],rate=.5), 1000, N[2])
X_25 <- matrix( rexp(1000*N[3],rate=.5), 1000, N[3])
Xbar_5 <- apply(X_5, 1, mean)
Xbar_12 <- apply(X_12, 1, mean)
Xbar_25 <- apply(X_25, 1, mean)
plot4hist(Xbar_5, Xbar_12, Xbar_25, 2, 4, rexp(1000),2)
X_5 <- matrix( rt(1000*N[1],df=3), 1000, N[1])
X_12 <- matrix( rt(1000*N[2],df=3), 1000, N[2])
X_25 <- matrix( rt(1000*N[3],df=3), 1000, N[3])
Xbar_5 <- apply(X_5, 1, mean)
Xbar_12 <- apply(X_12, 1, mean)
Xbar_25 <- apply(X_25, 1, mean)
plot4hist(Xbar_5, Xbar_12, Xbar_25, 0, 3, rt(1000,df=3),8)
Z = rnorm(1000, mean=1.5, sd=sqrt(1.43)) 
P = 1/(1 + exp(-Z)) 
p = mean(P) 
var_p = (n-1)*var(P)/n 
z <- qnorm(1-(.05/2)) 
c(p - z*sqrt(var_p/1000), p + z*sqrt(var_p/1000))
U <- runif(100000, 0, 2*pi)
hU <- sin(U*cos(U))
2*pi*mean(hU)
h <- function(u) sin(u*cos(u))
integrate(h, 0, 2*pi)$val
X <- rnorm(100000) 
Y <- sin(X*cos(X))/dnorm(X) 
mean(Y)
X <- runif(100000,0,10) 
Y <- 10*exp(-2*abs(X-5))
c( mean(Y), var(Y) ) 
X=rnorm(1e5,mean=5,sd=1)
Y=10*f(X)*dunif(X,0,10)/dnorm(X,mean=5,sd=1)
c( mean(Y), var(Y) ) 
X <- rnorm(1e5, sd=2) 
Y <- (X^2) * .5 * exp(-abs(X))/dnorm(X, sd=2) 
mean(Y)
